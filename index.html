<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VozStudio - Transforma a tua voz em m√∫sica</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="estilo.css">
    <link rel="manifest" href="manifest.json">
    
    <!-- Cores do tema para PWA -->
    <meta name="theme-color" content="#764ba2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé§ Voz<span>Studio</span></h1>
            <p>Grava a tua voz e n√≥s criamos a m√∫sica profissional</p>
        </header>

        <main>
            <!-- √Årea de grava√ß√£o -->
            <div class="gravador-card">
                <div class="visualizador">
                    <canvas id="waveform" width="300" height="100"></canvas>
                </div>
                
                <div class="controles-gravacao">
                    <button id="btnGravar" class="btn-gravar">
                        <span>üéôÔ∏è</span> Gravar Voz
                    </button>
                    <button id="btnParar" class="btn-parar" disabled>
                        ‚èπÔ∏è Parar
                    </button>
                </div>

                <div id="infoVoz" class="info-voz">
                    <p>Aguardando grava√ß√£o...</p>
                </div>
            </div>

            <!-- Personaliza o teu som -->
            <div class="config-card">
                <h3>üéõÔ∏è Personaliza o teu som</h3>
                
                <div class="config-grupo">
                    <label>Estilo musical:</label>
                    <select id="estiloMusical">
                        <option value="pop">Pop (comercial)</option>
                        <option value="rap">Rap/Trap</option>
                        <option value="kizomba">Kizomba</option>
                        <option value="semba">Semba</option>
                        <option value="afrobeat">Afrobeat</option>
                        <option value="gospel">Gospel</option>
                        <option value="acustico">Ac√∫stico</option>
                    </select>
                </div>

                <div class="config-grupo">
                    <label>Andamento (BPM):</label>
                    <input type="range" id="bpm" min="60" max="180" value="100">
                    <span id="bpmValor">100 BPM</span>
                </div>

                <div class="config-grupo">
                    <label>Tom principal:</label>
                    <select id="tom">
                        <option value="C">D√≥ (C) - Alegre</option>
                        <option value="D">R√© (D) - Dan√ßante</option>
                        <option value="E">Mi (E) - Energ√©tico</option>
                        <option value="F">F√° (F) - Suave</option>
                        <option value="G">Sol (G) - Vibrante</option>
                        <option value="A">L√° (A) - Calmo</option>
                        <option value="B">Si (B) - Intenso</option>
                    </select>
                </div>

                <div class="config-grupo">
                    <label>Instrumentos:</label>
                    <div class="checkbox-grupo">
                        <label><input type="checkbox" id="instPiano" checked> üéπ Piano</label>
                        <label><input type="checkbox" id="instBaixo" checked> üé∏ Baixo</label>
                        <label><input type="checkbox" id="instBateria" checked> ü•Å Bateria</label>
                        <label><input type="checkbox" id="instGuitarra"> üé∏ Guitarra</label>
                        <label><input type="checkbox" id="instCordas"> üéª Cordas</label>
                        <label><input type="checkbox" id="instMetal"> üé∫ Metais</label>
                    </div>
                </div>
            </div>

            <!-- Bot√£o de gera√ß√£o -->
            <div class="acao-principal">
                <button id="btnGerar" class="btn-gerar">
                    ‚ú® Criar M√∫sica Completa ‚ú®
                </button>
            </div>

            <!-- Player e resultado -->
            <div class="resultado-card" id="resultado" style="display: none;">
                <h3>üéµ Tua m√∫sica est√° pronta!</h3>
                
                <audio id="player" controls></audio>
                
                <div class="botoes-exportar">
                    <button id="btnMP3">‚¨áÔ∏è Download MP3</button>
                    <button id="btnWAV">‚¨áÔ∏è Download WAV (qualidade)</button>
                    <button id="btnCompartilhar">üì± Compartilhar</button>
                </div>

                <div class="info-profissional">
                    <p>‚úÖ Masteriza√ß√£o profissional aplicada</p>
                    <p>‚úÖ Pronto para Spotify/YouTube</p>
                    <p>‚úÖ Podes gravar mais takes</p>
                </div>
            </div>
        </main>

        <footer>
            <p>üéØ Tens uma voz incr√≠vel? N√≥s fazemos o resto!</p>
        </footer>
    </div>

    <!-- SCRIPTS NA ORDEM CORRETA -->
    <script src="https://cdn.jsdelivr.net/npm/tone"></script>
    <script src="gravador.js"></script>
    <script src="analisador.js"></script>
    <script src="gerador.js"></script>
    <script src="mixador.js"></script>
    <script src="app.js"></script>

    <!-- INICIALIZA√á√ÉO COM VERIFICA√á√ÉO -->
    <script>
        window.addEventListener('load', function() {
            console.log('üì± P√°gina carregada');
            
            // Verificar se todas as classes existem
            const classes = {
                'GravadorVoz': typeof GravadorVoz !== 'undefined',
                'AnalisadorVoz': typeof AnalisadorVoz !== 'undefined',
                'GeradorMusical': typeof GeradorMusical !== 'undefined',
                'MixadorProfissional': typeof MixadorProfissional !== 'undefined',
                'VozStudio': typeof VozStudio !== 'undefined'
            };
            
            console.log('Classes verificadas:', classes);
            
            // Verificar se alguma est√° faltando
            const faltando = Object.entries(classes)
                .filter(([_, existe]) => !existe)
                .map(([nome]) => nome);
            
            if (faltando.length > 0) {
                document.getElementById('infoVoz').innerHTML = 
                    `<p style="color: red; background: rgba(255,0,0,0.2); padding: 10px; border-radius: 10px;">
                        ‚ùå Erro: ${faltando.join(', ')} n√£o definido
                    </p>`;
                return;
            }
            
            // Tudo ok, iniciar app
            try {
                window.app = new VozStudio();
                window.app.inicializar();
                document.getElementById('infoVoz').innerHTML = 
                    '<p style="color: green; background: rgba(0,255,0,0.2); padding: 10px; border-radius: 10px;">‚úÖ App pronta! Clique em Gravar Voz</p>';
            } catch (erro) {
                document.getElementById('infoVoz').innerHTML = 
                    `<p style="color: red; background: rgba(255,0,0,0.2); padding: 10px; border-radius: 10px;">
                        ‚ùå Erro: ${erro.message}
                    </p>`;
            }
        });
    </script>
</body>
</html>